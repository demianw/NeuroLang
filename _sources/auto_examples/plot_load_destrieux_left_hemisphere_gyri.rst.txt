.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_load_destrieux_left_hemisphere_gyri.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_plot_load_destrieux_left_hemisphere_gyri.py:


Loading and Querying the Destrieux et al. Atlas' Left Hemisphere
========================================================================


Uploading the Destrieux regions NeuroLang and
executing a simple query.


.. code-block:: default


    from matplotlib import pyplot as plt
    import nibabel as nib
    from nilearn import datasets, plotting
    from neurolang.frontend import NeurolangDL






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
      return f(*args, **kwds)




Initialise the NeuroLang probabilistic engine.


.. code-block:: default


    nl = NeurolangDL()









Load the Destrieux example from nilearn as a fact list


.. code-block:: default



    atlas_destrieux = datasets.fetch_atlas_destrieux_2009()
    atlas_labels = {
        label: str(name.decode('utf8'))
        for label, name in atlas_destrieux['labels']
    }


    nl.add_atlas_set('destrieux_atlas', atlas_labels, nib.load(atlas_destrieux['maps']))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    Dataset created in /home/runner/nilearn_data/destrieux_2009

    Downloading data from https://www.nitrc.org/frs/download.php/7739/destrieux2009.tgz ...
    Downloaded 167791 of 167791 bytes (100.0%,    0.0s remaining) ...done. (2 seconds, 0 min)
    Extracting data from /home/runner/nilearn_data/destrieux_2009/942c6b3a7dffa09bfce32de953622ba3/destrieux2009.tgz..... done.
    /opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/numpy/lib/npyio.py:2349: VisibleDeprecationWarning: Reading unicode strings without specifying the encoding argument is deprecated. Set the encoding, use None for the system default.
      output = genfromtxt(fname, **kwargs)

    destrieux_atlas: typing.AbstractSet[typing.Tuple[str, neurolang.regions.ExplicitVBR]] = ('Background', Region(VBR= affine:[[   2.    0.    0.  -76.]
     [   0.    2.    0. -109.]
     [   0.    0.    2.  -64.]
     [   0.    0.    0.    1.]], voxels:[[ 0  0  0]
     [ 0  0  1]
     [ 0  0  2]
     ...
     [75 92 73]
     [75 92 74]
     [75 92 75]])) ...



Add utility function


.. code-block:: default



    @nl.add_symbol
    def startswith(prefix: str, s: str) -> bool:
        return s.startswith(prefix)








Query all left hemisphere regions superior to the temporal superior sulucs
and anterior to the central sulcus


.. code-block:: default



    with nl.scope as e:
        e.on_left_hemisphere[e.x] = (
                e.destrieux_atlas(e.l, e.x) & e.startswith('L S', e.l)
        )

        result = nl.query((e.r,), e.on_left_hemisphere(e.r))









Visualise results


.. code-block:: default


    subplots = plt.subplots(
        nrows=len(result), ncols=1,
        figsize=(10, 5 * len(result))
    )[1]

    for (r, subplot) in zip(result, subplots):
        region = r[0]
        plotting.plot_roi(region.spatial_image(), axes=subplot)



.. image:: /auto_examples/images/sphx_glr_plot_load_destrieux_left_hemisphere_gyri_001.png
    :alt: plot load destrieux left hemisphere gyri
    :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  43.384 seconds)


.. _sphx_glr_download_auto_examples_plot_load_destrieux_left_hemisphere_gyri.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_load_destrieux_left_hemisphere_gyri.py <plot_load_destrieux_left_hemisphere_gyri.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_load_destrieux_left_hemisphere_gyri.ipynb <plot_load_destrieux_left_hemisphere_gyri.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
